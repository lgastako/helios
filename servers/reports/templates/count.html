{% extends "_base.html" %}

{% block title %}Counts for {{ collection_name }}{% endblock %}

{% block content %}
<article>
  <h1>Counts for collection: {{ collection_name }}</h1>
  <h3>
    {% if group_by %}
    Showing counts grouped by key: {{ group_by }}
    {% else %}
    Showing ungrouped counts
    {% endif %}
  </h3>
  <table>
    <tr>
      <th>Value</th>
      <th>Count</th>
    </tr>
{% if results %}
    {% for link, doc in results: %}
    <tr>
      <td><a href="{{ link }}">{{ doc._id }}</a></td>
      <td>{{ doc.value }}</td>
    </tr>
    {% endfor %}
{% else %}
    <tr>
      <td>ALL</td>
      <td>{{ count }}</td>
    </tr>
{% endif %}
  </table>
  <h3>Group Options</h3>
  <form method="get">
    <label>Group by
      <input type="text" name="group_by" value="{{ group_by or "" }}"/>
    </label>
    <input class="button" type="submit" value="(Re)Group"/>
  </form>
</article>
{% endblock %}

{% block extra_nav %}
<h4>Context Nav</h4>
<ul>
  <li><a href="/col/{{ collection_name }}">Collection View</a></li>
  <li><a id="chart" href="/count/{{ collection_name }}/chart{% if group_by %}?group_by={{ group_by }}{% endif %}">Chart</a></li>
</ul>
{% endblock %}
